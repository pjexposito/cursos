{% extends 'cursos/base.html' %}
{% load static %}
{% block content %}

<section class="course-categories">
    <div class="titulo">
        <h2><a href="/">Formaci√≥n</a></h2>
    </div>

    <div class="cursos-importantes">
        <h3>Cursos importantes pendientes</h3>
        <div class="cursos-pendientes">
            {% for curso in cursos_importantes_pendientes %}
                <div class="curso-pendiente">
                    <img src="{{ curso.miniatura.url }}" class="background-image" alt="Imagen del curso">
                    <h4><a href="{% url 'detalle_curso' pk=curso.pk %}" title='{{ curso.explicacion|linebreaksbr }}'>{{ curso.titulo }}</a></h4>
                    <p>‚è±Ô∏è {{curso.duracion}} min</p>
                </div>
                <p></p>
            {% endfor %}
        </div>
    </div>
    <br>

    <h2>Cat√°logo formativo</h2>
    <br>

    <div class="categories-grid">
        {% for categoria, lecciones in lecciones_por_categoria.items %}
        <div class="category">
            <h3 class="category-title" onclick="toggleCategory('{{ categoria.id }}')">{{ categoria.titulo }}</h3>
            <div class="category-content" id="category-{{ categoria.id }}" style="display: none;">
                {% for curso, total_lecciones, lecciones_completadas, total_puntos, total_puntos_obtenidos in lecciones %}
                <div class="category-item {% if lecciones_completadas == total_lecciones %}completed{% endif %}">
                    <div class="category-image">
                        <img src="{{ curso.miniatura.url }}" alt="Imagen del curso">
                    </div>
                    <div class="category-content">
                        <h4><a href="{% url 'detalle_curso' pk=curso.pk %}" title='{{ curso.explicacion|linebreaksbr }}'>{{ curso.titulo }}</a></h4>
                        <p>{{ curso.miniexplicacion|linebreaksbr }}</p>
                        <div class="category-meta">
                            {% if lecciones_completadas == total_lecciones %}
                                <span>üèÜ {{ total_puntos_obtenidos }}/{{ total_puntos }} puntos</span>
                            {% else %}
                                <span>üïπÔ∏è {{ total_puntos_obtenidos }}/{{ total_puntos }} puntos</span>
                            {% endif %}
                            <span>üéì {{ lecciones_completadas }}/{{ total_lecciones }}</span>
                            <span>‚è±Ô∏è {{curso.duracion}} min</span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
</section>

<script>
function toggleCategory(categoriaId) {
    const content = document.getElementById(`category-${categoriaId}`);
    const isDisplayed = content.style.display === 'block';
    content.style.display = isDisplayed ? 'none' : 'block';
}
</script>

{% endblock %}
